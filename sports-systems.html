<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BrainHustle‚Ñ¢ ‚Äì Sports Systems (Upgraded Members)</title>
  <meta name="description" content="BrainHustle‚Ñ¢ Upgraded: sports betting systems and tools ‚Äî odds converter, no-vig pricing, Kelly sizing, CLV tracker, and a downloadable bet log. Education only."/>
  <style>
    :root{--bg:#0a0a0a;--panel:#121212;--ink:#fff;--muted:#b7b7b7;--accent:#00ff66;--accent2:#00cc66}
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Arial,Helvetica,sans-serif}
    a{color:var(--accent);text-decoration:none}
    .wrap{max-width:1120px;margin:0 auto;padding:26px 18px 64px}
    .topbar{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
    .brand{font-weight:700;font-size:22px}
    .menu-button{background:var(--accent2);border:none;border-radius:8px;padding:8px 12px;color:#000;font-size:18px;cursor:pointer}
    .side-menu{position:fixed;top:0;left:-260px;width:260px;height:100%;background:#111;border-right:1px solid #222;z-index:999;transition:left .25s ease}
    .side-menu a{display:block;color:#fff;padding:12px 18px;border-bottom:1px solid #222}
    .side-menu a:hover{background:#191919}
    .hero{padding:16px;border:1px solid #1c1c1c;border-radius:14px;background:linear-gradient(180deg,#0f0f0f,#0a0a0a);margin-bottom:16px}
    .hero h1{margin:6px 0 6px;font-size:24px}
    .hero p{color:var(--muted);line-height:1.5}
    .pill{display:inline-block;padding:3px 8px;border:1px solid #2a2a2a;border-radius:999px;margin-right:6px;color:#ddd;font-size:12px}
    .grid{display:grid;grid-template-columns:1fr;gap:16px}
    @media(min-width:980px){.grid{grid-template-columns:1fr 1fr}}
    .card{background:var(--panel);border:1px solid #1d1d1d;border-radius:14px;padding:16px}
    .card h2{margin:0 0 10px;font-size:20px}
    .card h3{margin:10px 0 8px;font-size:16px;color:var(--accent)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    label{display:block;margin:10px 0 6px}
    input[type="number"],input[type="text"]{width:100%;padding:10px;border-radius:10px;border:1px solid #2a2a2a;background:#0f0f0f;color:#fff}
    .btn{background:var(--accent);color:#000;border:none;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700}
    .btn.secondary{background:#1e1e1e;color:#fff;border:1px solid #2a2a2a}
    .result{margin-top:12px;padding:12px;border-radius:12px;background:#0f0f0f;border:1px solid #222}
    .muted{color:var(--muted)}
    .kicker{font-size:12px;color:var(--muted);margin-top:6px}
    .copy-line{display:flex;gap:8px;align-items:center;margin:8px 0}
    .copy-target{padding:10px;background:#0f0f0f;border:1px solid #222;border-radius:10px;color:#ddd;overflow:auto;white-space:pre-wrap}
    .downloads a{display:inline-block;margin-right:12px;margin-bottom:8px}
    .ok{color:#7CFC00}.warn{color:#ffcf33}.bad{color:#ff6b6b}
    .foot{margin-top:18px;color:#888;font-size:12px}
    /* gating containers */
    #upgradedContent,#starterTeaser{display:none}
    .center{text-align:center}
  </style>
</head>
<body>
  <!-- Side Menu -->
  <nav id="sideMenu" class="side-menu">
    <a href="dashboard.html">üè† Dashboard</a>
    <a href="ideas.html">üí° Ideas</a>
    <a href="kits.html">üß∞ Kits</a>
    <a href="about.html">‚ÑπÔ∏è About</a>
    <a href="upgrade.html">‚¨ÜÔ∏è Upgrade</a>
    <a href="sports-systems.html">üèà Sports Systems</a>
  </nav>

  <div class="wrap">
    <div class="topbar">
      <div class="brand">üß† BrainHustle‚Ñ¢ <span class="muted">Sports Systems</span></div>
      <button class="menu-button" onclick="toggleMenu()">‚ò∞ Menu</button>
    </div>

    <section class="hero">
      <h1>Upgraded Members: Data-Driven Sports Systems</h1>
      <p>Not picks. <b>Process</b>. You‚Äôll get calculators and a bet-tracking system to control risk and measure edge:
      <b>odds converter</b>, <b>no-vig fair pricing</b>, <b>Kelly bet sizing</b>, and <b>CLV checker</b>.</p>
      <div>
        <span class="pill">1‚Äì2% per bet</span>
        <span class="pill">Line-shopping</span>
        <span class="pill">Track CLV</span>
        <span class="pill">No-vig math</span>
      </div>
    </section>

    <!-- Starter Teaser (shown if not upgraded) -->
    <div id="starterTeaser" class="card center">
      <h2>Upgrade Required</h2>
      <p class="muted">This Sports Systems module is for <b>Upgraded</b> members only.</p>
      <a class="btn" href="upgrade.html">Unlock Now</a>
      <div class="kicker">Already upgraded? Make sure you‚Äôre logged in with the same email.</div>
    </div>

    <!-- Upgraded Content (shown if upgraded) -->
    <div id="upgradedContent">

      <div class="grid">
        <!-- Odds Converter -->
        <div class="card">
          <h2>Odds Converter & Implied Probability</h2>
          <div class="row">
            <div>
              <label>American Odds</label>
              <input id="oddsAmerican" type="number" placeholder="-110"/>
            </div>
            <div>
              <label>Decimal Odds</label>
              <input id="oddsDecimal" type="number" step="0.001" placeholder="1.909"/>
            </div>
          </div>
          <div class="row">
            <div>
              <label>Fractional Odds</label>
              <input id="oddsFractional" type="text" placeholder="11/10"/>
            </div>
            <div>
              <label>Implied Probability (%)</label>
              <input id="oddsProb" type="number" step="0.01" placeholder="52.38"/>
            </div>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn" onclick="convertFromAmerican()">Convert from American</button>
            <button class="btn" onclick="convertFromDecimal()">Convert from Decimal</button>
            <button class="btn" onclick="convertFromFractional()">Convert from Fractional</button>
            <button class="btn secondary" onclick="clearOdds()">Clear</button>
          </div>
          <div class="result muted kicker">Implied probability ignores vig.</div>
        </div>

        <!-- No-Vig -->
        <div class="card">
          <h2>No-Vig (Fair) Probabilities ‚Äî Two-Way Market</h2>
          <div class="row">
            <div>
              <label>Side A (American)</label>
              <input id="nvA" type="number" placeholder="-110"/>
            </div>
            <div>
              <label>Side B (American)</label>
              <input id="nvB" type="number" placeholder="-110"/>
            </div>
          </div>
          <div style="margin-top:10px">
            <button class="btn" onclick="calcNoVig()">Calculate Fair %</button>
          </div>
          <div id="nvOut" class="result"></div>
          <div class="kicker">Fair splits normalize the implied probs to 100% total.</div>
        </div>

        <!-- Kelly -->
        <div class="card">
          <h2>Kelly Bet Sizing</h2>
          <div class="row">
            <div>
              <label>Bankroll ($)</label>
              <input id="kellyBank" type="number" step="0.01" placeholder="500"/>
            </div>
            <div>
              <label>Offered Odds (American)</label>
              <input id="kellyAmerican" type="number" placeholder="-110"/>
            </div>
          </div>
          <div class="row">
            <div>
              <label>Your True Win Probability (%)</label>
              <input id="kellyP" type="number" step="0.01" placeholder="53"/>
            </div>
            <div>
              <label>Fractional Kelly (0.25‚Äì1.0)</label>
              <input id="kellyFrac" type="number" step="0.05" value="0.5"/>
            </div>
          </div>
          <div style="margin-top:10px">
            <button class="btn" onclick="calcKelly()">Calculate Kelly</button>
          </div>
          <div id="kellyOut" class="result"></div>
          <div class="kicker">If Kelly ‚â§ 0 ‚Üí edge is negative ‚Üí No bet.</div>
        </div>

        <!-- CLV -->
        <div class="card">
          <h2>CLV (Closing Line Value) Checker</h2>
          <div class="row">
            <div>
              <label>Your Price (American)</label>
              <input id="clvYours" type="number" placeholder="-110"/>
            </div>
            <div>
              <label>Closing Price (American)</label>
              <input id="clvClose" type="number" placeholder="-120"/>
            </div>
          </div>
          <div style="margin-top:10px">
            <button class="btn" onclick="calcCLV()">Check CLV</button>
          </div>
          <div id="clvOut" class="result"></div>
          <div class="kicker">Consistently beating the closing price is a strong signal of edge.</div>
        </div>

        <!-- Downloads & Copyables -->
        <div class="card">
          <h2>Upgraded Downloads & Copyables</h2>
          <p class="muted">Use the log to track stake %, odds, and CLV. Flat bet 1‚Äì2% until you‚Äôve proven edge.</p>
          <div class="downloads">
            <!-- Replace hrefs after uploading to your repo -->
            <a class="btn" href="/assets/BrainHustle_Sports_Log.xlsx" download>‚¨áÔ∏è Sports Betting Log (.xlsx)</a>
            <a class="btn secondary" href="/assets/BrainHustle_Sports_Log.csv" download>‚¨áÔ∏è CSV Version</a>
          </div>

          <h3>Copy: CSV Header</h3>
          <div class="copy-line">
            <button class="btn" onclick="copyById('csvHeader')">Copy</button>
            <div id="csvHeader" class="copy-target">Date (YYYY-MM-DD),Sport,League,Event / Matchup,Book,Bet Type (ML/Spread/Total/Prop),Side/Selection,American Odds,Decimal Odds,Stake ($),Line (e.g., -3.5 / 47.5),Result (W/L/P),Payout ($),Profit/Loss ($),Bankroll Before ($),Bankroll After ($),Closing Line (Book),Closing Odds (American),CLV (Closing - Your Odds, in cents),Notes</div>
          </div>

          <h3>Copy: Responsible-Play Block</h3>
          <div class="copy-line">
            <button class="btn" onclick="copyById('legalBlock')">Copy</button>
            <div id="legalBlock" class="copy-target">BrainHustle‚Ñ¢ provides educational content only. Nothing here is betting advice or a guarantee of profit.
Sports betting involves risk. Only bet what you can afford to lose. Must be 21+ (or legal age in your jurisdiction).
Check and follow all local laws; availability varies by state/country. If gambling is a problem, seek help (e.g., 1-800-GAMBLER in the U.S.). By using this site you accept our Terms, Disclaimers, and Privacy Policy.</div>
          </div>
        </div>

        <!-- Playbook -->
        <div class="card">
          <h2>Daily Playbook</h2>
          <ol>
            <li>Specialize (e.g., NCAAF spreads).</li>
            <li>Make a fair line or % (even simple models beat vibes).</li>
            <li>Shop 2‚Äì4 books; take the best price.</li>
            <li>Sanity-check with the No-Vig calculator.</li>
            <li>Stake 1‚Äì2% (or fractional Kelly if your edge is proven).</li>
            <li>Record every bet and track CLV.</li>
            <li>Weekly review: if you aren‚Äôt beating the close, tune inputs.</li>
          </ol>
          <div class="kicker">Next phase: add pace/efficiency stats, simulate totals, flag misprices automatically.</div>
        </div>

        <!-- Education Roadmap -->
        <div class="card">
          <h2>Education Roadmap</h2>
          <ul>
            <li><b>101:</b> Odds, vig, implied probability, bet types</li>
            <li><b>201:</b> Bankroll, variance, unit sizing</li>
            <li><b>301:</b> No-vig pricing, CLV, line-shopping</li>
            <li><b>401:</b> Simple models (pace, efficiency, injuries)</li>
            <li><b>501:</b> EV + uncertainty, fractional Kelly</li>
          </ul>
        </div>
      </div>

      <div class="foot">¬© BrainHustle‚Ñ¢ ‚Äî Education only. No guarantees. Play responsibly.</div>
    </div>
  </div>

  <!-- Firebase SDK (Compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

  <script>
    // --- Side menu toggle ---
    function toggleMenu(){
      const m = document.getElementById('sideMenu');
      m.style.left = (m.style.left==='0px') ? '-260px' : '0px';
    }

    // --- Firebase init (BrainHustle project) ---
    const firebaseConfig = {
      apiKey: "AIzaSyA1cS4bIOxNAQuDFsyRq6mGzz9xeKqKFiY",
      authDomain: "brainhustle-92a40.firebaseapp.com",
      projectId: "brainhustle-92a40",
      storageBucket: "brainhustle-92a40.firebasestorage.app",
      messagingSenderId: "547592914180",
      appId: "1:547592914180:web:be4969f6a657c2b6c9bc51",
      measurementId: "G-3M5PKR5S27"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // --- Gating helpers ---
    const showUpgraded = () => {
      document.getElementById('starterTeaser').style.display = 'none';
      document.getElementById('upgradedContent').style.display = 'block';
    };
    const showTeaser = (why) => {
      document.getElementById('starterTeaser').style.display = 'block';
      document.getElementById('upgradedContent').style.display = 'none';
      if(why){ console.log('Teaser reason:', why); }
    };

    // Check auth + membership (expects Firestore collection 'members' with doc { level: "starter"|"upgraded" })
    auth.onAuthStateChanged(async (user) => {
      if(!user){ showTeaser('no-user'); return; }
      try{
        const doc = await db.collection('members').doc(user.uid).get();
        const level = (doc.exists && doc.data().level) ? String(doc.data().level) : 'starter';
        if(level.toLowerCase() === 'upgraded'){ showUpgraded(); }
        else{ showTeaser('starter'); }
      }catch(e){
        console.error(e); showTeaser('error');
      }
    });

    // ---------- Utility ----------
    const clamp = (v,min,max)=>Math.max(min,Math.min(max,v));
    const toPct = x => (x*100).toFixed(2);
    const fromPct = p => clamp(Number(p)/100, 0.0001, 0.9999);

    // ---------- Odds & Prob helpers ----------
    function americanToDecimal(A){ A=Number(A); if(isNaN(A)||A===0) return null; return A>0?1+(A/100):1+(100/Math.abs(A)); }
    function decimalToAmerican(D){ D=Number(D); if(isNaN(D)||D<=1) return null; return D>=2?Math.round((D-1)*100): -Math.round(100/(D-1)); }
    function americanToProb(A){ A=Number(A); if(isNaN(A)||A===0) return null; return A>0? (100/(A+100)) : (Math.abs(A)/(Math.abs(A)+100)); }
    function probToAmerican(p){ p=clamp(Number(p),0.0001,0.9999); return p<0.5 ? Math.round(100*(1-p)/p) : -Math.round(100*p/(1-p)); }
    function fracStr(D){ if(!D) return ""; const num=Math.round((D-1)*100), den=100; const gcd=(a,b)=>b?gcd(b,a%b):a; const g=gcd(num,den); return (num/g)+"/"+(den/g); function gcd(a,b){return b?gcd(b,a%b):a} }
    function fracToDec(fr){ if(!fr) return null; const parts=fr.replace(/\s/g,'').split('/'); if(parts.length!==2) return null; const a=Number(parts[0]), b=Number(parts[1]); if(!isFinite(a)||!isFinite(b)||b===0) return null; return 1+(a/b); }

    // ---------- Converter ----------
    function convertFromAmerican(){
      const A=Number(document.getElementById('oddsAmerican').value);
      const D=americanToDecimal(A), p=americanToProb(A);
      if(D){ document.getElementById('oddsDecimal').value=D.toFixed(3); document.getElementById('oddsFractional').value=fracStr(D); }
      if(p){ document.getElementById('oddsProb').value=(p*100).toFixed(2); }
    }
    function convertFromDecimal(){
      const D=Number(document.getElementById('oddsDecimal').value);
      const A=decimalToAmerican(D); if(A!==null){ document.getElementById('oddsAmerican').value=A; }
      const p=(D>1)?(1/D):null; if(p){ document.getElementById('oddsProb').value=(p*100).toFixed(2); }
      if(D){ document.getElementById('oddsFractional').value=fracStr(D); }
    }
    function convertFromFractional(){
      const fr=document.getElementById('oddsFractional').value;
      const D=fracToDec(fr); if(D){ document.getElementById('oddsDecimal').value=D.toFixed(3); }
      const A=D?decimalToAmerican(D):null; if(A!==null){ document.getElementById('oddsAmerican').value=A; }
      const p=D?(1/D):null; if(p){ document.getElementById('oddsProb').value=(p*100).toFixed(2); }
    }
    function clearOdds(){ ['oddsAmerican','oddsDecimal','oddsFractional','oddsProb'].forEach(id=>document.getElementById(id).value=""); }

    // ---------- No-Vig ----------
    function calcNoVig(){
      const A=Number(document.getElementById('nvA').value);
      const B=Number(document.getElementById('nvB').value);
      const pa=americanToProb(A), pb=americanToProb(B);
      if(!pa||!pb){ document.getElementById('nvOut').innerHTML='<span class="bad">Enter valid odds.</span>'; return; }
      const s=pa+pb, fa=pa/s, fb=pb/s;
      const aFairAmerican=probToAmerican(fa), bFairAmerican=probToAmerican(fb);
      document.getElementById('nvOut').innerHTML =
        `<div><b>Implied (with vig):</b> A=${toPct(pa)}% ¬∑ B=${toPct(pb)}% ¬∑ Sum=${toPct(s)}%</div>
         <div><b>Fair (no-vig):</b> A=${toPct(fa)}% (‚âà ${aFairAmerican}) ¬∑ B=${toPct(fb)}% (‚âà ${bFairAmerican})</div>`;
    }

    // ---------- Kelly ----------
    function calcKelly(){
      const bank=Number(document.getElementById('kellyBank').value||0);
      const A=Number(document.getElementById('kellyAmerican').value);
      const p=fromPct(document.getElementById('kellyP').value||0);
      const frac=clamp(Number(document.getElementById('kellyFrac').value||0.5),0,1);
      const D=americanToDecimal(A);
      if(!bank||!D||!p){ document.getElementById('kellyOut').innerHTML='<span class="bad">Enter bankroll, odds, and your true win %.</span>'; return; }
      const b=D-1, q=1-p; let f=(b*p - q)/b; if(!isFinite(f)) f=-1;
      let msg, css='muted';
      if(f<=0){ msg='No bet (negative edge).'; css='bad'; }
      else{ const stake=bank*f*frac; msg=`Kelly fraction ${(f*100).toFixed(2)}% ¬∑ Fractional ${(frac*100).toFixed(0)}% ‚Üí Stake ‚âà $${stake.toFixed(2)}`; css='ok'; }
      document.getElementById('kellyOut').innerHTML=`<span class="${css}">${msg}</span>`;
    }

    // ---------- CLV ----------
    function calcCLV(){
      const y=Number(document.getElementById('clvYours').value);
      const c=Number(document.getElementById('clvClose').value);
      const py=americanToProb(y), pc=americanToProb(c);
      if(!py||!pc){ document.getElementById('clvOut').innerHTML='<span class="bad">Enter valid American prices.</span>'; return; }
      const beat=(py<pc);
      let centsNote='Cents diff: n/a';
      if((y<0&&c<0)||(y>0&&c>0)){
        const cy=Math.abs(y), cc=Math.abs(c);
        const cents = (y<0 ? (cc - cy) : (y - c)); // +cents = you beat it
        centsNote = `Approx ‚Äúcents‚Äù edge: ${cents>0?'+':''}${cents.toFixed(0)}¬¢`;
      }
      document.getElementById('clvOut').innerHTML =
        `<div>Implied prob (yours): ${(py*100).toFixed(2)}% ¬∑ close: ${(pc*100).toFixed(2)}%</div>
         <div>${centsNote}</div>
         <div>Status: ${beat?'<span class="ok">You beat the close ‚úÖ</span>':'<span class="warn">Worse than close ‚ö†Ô∏è</span>'}</div>`;
    }

    // ---------- Copy helper ----------
    async function copyById(id){
      const txt=document.getElementById(id).innerText;
      try{
        await navigator.clipboard.writeText(txt);
        const btn=event?.target; if(btn){ const t=btn.innerText; btn.innerText='Copied!'; setTimeout(()=>btn.innerText='Copy',1100); }
      }catch(e){ alert('Copy failed. Select and copy manually.'); }
    }
  </script>
</body>
</html>
